---
import Layout from "../layouts/Layout.astro";
import { MyFlashcardsLibrary } from "../components/my-flashcards/MyFlashcardsLibrary";
import { ToastProvider } from "../components/ToastProvider";

// This page is protected by middleware (see src/middleware/index.ts)
// The middleware redirects unauthenticated users to /auth/login
const { user } = Astro.locals;

// TypeScript doesn't know that middleware guarantees user is defined,
// so we add this check to satisfy the type checker
if (!user) {
  return Astro.redirect("/auth/login");
}
---

<Layout title="Moje Fiszki - 10x Cards" description="Przeglądaj, edytuj i zarządzaj swoją kolekcją fiszek">
  <MyFlashcardsLibrary client:only="react" />
  <ToastProvider client:only="react" />
</Layout>
