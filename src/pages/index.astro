---
import Layout from "../layouts/Layout.astro";
import { FlashcardGenerator } from "../components/flashcard-generator/FlashcardGenerator";
import { ToastProvider } from "../components/ToastProvider";

// This page is protected by middleware (see src/middleware/index.ts)
// The middleware redirects unauthenticated users to /auth/login
const { user } = Astro.locals;

// TypeScript doesn't know that middleware guarantees user is defined,
// so we add this check to satisfy the type checker
if (!user) {
  return Astro.redirect("/auth/login");
}
---

<Layout title="Generator Fiszek - 10x Cards" description="Wygeneruj fiszki do nauki za pomocÄ… AI">
  <FlashcardGenerator client:load />
  <ToastProvider client:only="react" />
</Layout>
